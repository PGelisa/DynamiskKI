<!DOCTYPE html>
<html lang="no" class="h-full bg-gray-50">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prosjektsider</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="h-full flex items-center justify-center bg-gray-100 p-4">

    <div class="w-full max-w-2xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8">
        <header class="text-center mb-6 border-b pb-4">
            <h1 id="page-title" class="text-3xl font-bold text-gray-800">Laster inn...</h1>
            <p id="page-description" class="text-md text-gray-500 mt-2">Søker etter filer og mapper.</p>
        </header>

        <main>
            <!-- Liste med filer og mapper vil bli satt inn her -->
            <ul id="file-list" class="space-y-2">
                <!-- Innhold genereres av JavaScript -->
            </ul>

            <!-- Vises hvis ingen elementer blir funnet -->
            <div id="no-files-message" class="hidden text-center text-gray-500 mt-6 bg-gray-50 p-6 rounded-lg">
                <p>Fant ingen HTML-filer eller undermapper her.</p>
            </div>
        </main>
        
        <footer class="text-center text-xs text-gray-400 mt-8 pt-4 border-t">
            <p>Listen genereres automatisk via GitHub API.</p>
        </footer>
    </div>

    <script>
        // --- KONFIGURASJON ---
        const GITHUB_USERNAME = "PGelisa"; // Bytt ut med ditt GitHub-brukernavn
        const GITHUB_REPO_NAME = "DynamiskKI"; // Bytt ut med navnet på ditt repository
        // Valgfri: Spesifiser en startmappe. La stå som "" for å starte i roten av prosjektet.
        const ROOT_FOLDER_PATH = ""; 
        const PAGE_TITLE = "Mine KI-prosjekter"; // Tittelen som skal vises på siden
        // --- SLUTT PÅ KONFIGURASJON ---

        // Funksjon for å hente og vise filene
        async function fetchAndDisplayFiles() {
            const fileListContainer = document.getElementById('file-list');
            const pageTitleElement = document.getElementById('page-title');
            const pageDescriptionElement = document.getElementById('page-description');
            
            // Finner nåværende mappe fra URL-parameteren '?path='
            const urlParams = new URLSearchParams(window.location.search);
            const currentPath = urlParams.get('path') || ROOT_FOLDER_PATH;

            pageTitleElement.textContent = PAGE_TITLE;
            pageDescriptionElement.textContent = `Innhold i: /${currentPath}`;
            
            const apiUrl = `https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO_NAME}/contents/${currentPath}`;

            try {
                const response = await fetch(apiUrl);
                if (!response.ok) throw new Error(`Nettverksfeil: ${response.statusText}`);
                const items = await response.json();

                fileListContainer.innerHTML = ''; // Tøm listen

                // Legg til "Gå opp"-lenke hvis vi er i en undermappe
                if (currentPath !== ROOT_FOLDER_PATH) {
                    const parentPath = currentPath.substring(0, currentPath.lastIndexOf('/')) || '';
                    const upLink = document.createElement('li');
                    upLink.innerHTML = `
                        <a href="?path=${parentPath}" class="flex items-center p-2 text-blue-600 hover:underline hover:bg-gray-100 rounded-md">
                            <svg class="w-5 h-5 mr-3 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15l5-5 5 5"/></svg>
                            .. (Gå opp)
                        </a>`;
                    fileListContainer.appendChild(upLink);
                }

                // Sorter mapper først, deretter filer
                const directories = items.filter(item => item.type === 'dir').sort((a, b) => a.name.localeCompare(b.name));
                const htmlFiles = items.filter(item => item.type === 'file' && item.name.endsWith('.html') && item.name.toLowerCase() !== 'index.html').sort((a, b) => a.name.localeCompare(b.name));

                if (directories.length === 0 && htmlFiles.length === 0) {
                    document.getElementById('no-files-message').classList.remove('hidden');
                }

                // Vis mapper
                directories.forEach(dir => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `
                        <a href="?path=${dir.path}" class="flex items-center p-2 text-blue-700 font-medium hover:underline hover:bg-gray-100 rounded-md">
                            <svg class="w-5 h-5 mr-3 flex-shrink-0 text-yellow-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" /></svg>
                            ${dir.name}
                        </a>`;
                    fileListContainer.appendChild(listItem);
                });

                // Vis HTML-filer
                htmlFiles.forEach(file => {
                    const listItem = document.createElement('li');
                    listItem.innerHTML = `
                        <a href="${file.path}" class="flex items-center p-2 text-gray-800 hover:underline hover:bg-gray-100 rounded-md">
                            <svg class="w-5 h-5 mr-3 flex-shrink-0 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" /></svg>
                            ${file.name}
                        </a>`;
                    fileListContainer.appendChild(listItem);
                });

            } catch (error) {
                fileListContainer.innerHTML = `<div class="text-center text-red-600 bg-red-50 p-4 rounded-lg">
                    <p>Kunne ikke laste innhold.</p>
                    <p class="text-sm mt-1">Feil: ${error.message}</p>
                    <p class="text-sm mt-2">Sjekk konfigurasjonen i scriptet.</p>
                </div>`;
            }
        }

        document.addEventListener('DOMContentLoaded', fetchAndDisplayFiles);
    </script>
</body>
</html>

